version: v1.0.0
steps:
# Build target image to initiate base image tracking
- build: -t {{.Run.Registry}}/staging/node:9-alpine -f import-node-dockerfile .
# Rather than push the rebuilt base image, 
# import it directly to maintain the digest and exact image contents, and SBoM from its source
# Login to the CLI
- cmd: "mcr.microsoft.com/azure-cli az login --identity -o table"
# Push Import Image
- cmd: "mcr.microsoft.com/azure-cli az acr import --name {{.Values.REGISTRY_CENTRAL}} --source {{.Run.Registry}}/public/node:9-alpine -t staging/node:9-alpine --force"
